"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6624],{6624:(le,B,s)=>{s.d(B,{L:()=>ee});var f=s(78560),U=s(80609),b=s(47090),$=s(18139),te=s(24453),se=s(78467),P=s(58837),ae=s(54917),ne=s(53373),O=s.n(ne),a=s(14041),u=s(22249);const re=(0,u.A)(e=>({text:{fill:e.palette.textContrast},secondary:{fill:e.palette.textSubtle}}),{name:"PluginCatalogGraphCustomLabel"});function R({edge:{relations:e}}){const n=re();return a.createElement("text",{className:n.text,textAnchor:"middle"},e.map((o,m)=>a.createElement("tspan",{key:o,className:O()(m%2!==0&&n.secondary)},m>0&&a.createElement("tspan",null," / "),o)))}var K=s(95208),w=s(53318),F=s(10437);function H({kind:e,...n}){var i;const m=(i=(0,K.n)().getSystemIcon(`kind:${e.toLocaleLowerCase("en-US")}`))!=null?i:F.A;return a.createElement(m,{...n})}var Q=s(55488);const j=(0,P.A)(e=>({node:{fill:e.palette.grey[300],stroke:e.palette.grey[300],"&.primary":{fill:e.palette.primary.light,stroke:e.palette.primary.light},"&.secondary":{fill:e.palette.secondary.light,stroke:e.palette.secondary.light}},text:{fill:e.palette.getContrastText(e.palette.grey[300]),"&.primary":{fill:e.palette.primary.contrastText},"&.secondary":{fill:e.palette.secondary.contrastText},"&.focused":{fontWeight:"bold"}},clickable:{cursor:"pointer"}}),{name:"PluginCatalogGraphCustomNode"});function Y({node:{id:e,entity:n,color:o="default",focused:m,onClick:i}}){const y=j(),[D,C]=(0,a.useState)(0),[A,T]=(0,a.useState)(0),E=(0,K.n)(),r=(0,a.useRef)(null);(0,a.useLayoutEffect)(()=>{if(r.current){let{height:v,width:I}=r.current.getBBox();v=Math.round(v),I=Math.round(I),(v!==A||I!==D)&&(C(I),T(v))}},[D,A]);const{kind:c,metadata:{name:x,namespace:g=Q.oQ,title:h}}=n,S=E.getSystemIcon(`kind:${c.toLocaleLowerCase("en-US")}`),p=10,L=A,M=S?L+p:0,l=M+D+p*2,d=A+p*2,t=h!=null?h:c&&x&&g?(0,w.S)({kind:c,name:x,namespace:g}):e;return a.createElement("g",{onClick:i,className:O()(i&&y.clickable)},a.createElement("rect",{className:O()(y.node,o==="primary"&&"primary",o==="secondary"&&"secondary"),width:l,height:d,rx:10}),S&&a.createElement(H,{kind:c,y:p,x:p,width:L,height:L,className:O()(y.text,m&&"focused",o==="primary"&&"primary",o==="secondary"&&"secondary")}),a.createElement("text",{ref:r,className:O()(y.text,m&&"focused",o==="primary"&&"primary",o==="secondary"&&"secondary"),y:d/2,x:M+(D+p*2)/2,textAnchor:"middle",alignmentBaseline:"middle"},t))}var V=s(54361),X=s(60241),z=s(22771),Z=s(30043),J=s(87290);function q(){const e=(0,$.gf)(Z.v),n=(0,a.useRef)({requestedEntities:new Set,outstandingEntities:new Map,cachedEntities:new Map}),[o,m]=(0,a.useState)({}),i=(0,a.useCallback)(()=>{const{cachedEntities:E,requestedEntities:r}=n.current,c={};r.forEach(x=>{const g=E.get(x);g&&(c[x]=g)}),m(c)},[n,m]),[y,D]=(0,J.A)(async()=>{const{requestedEntities:E,cachedEntities:r}=n.current,c=Array.from(E).filter(g=>!r.has(g));if(c.length===0){i();return}const{items:x}=await e.getEntitiesByRefs({entityRefs:c});x.forEach(g=>{if(g){const h=(0,f.U2)(g);r.set(h,g)}}),i()},[n,i]),{loading:C,error:A}=y,T=(0,a.useCallback)(E=>{const r=new Set(E),{requestedEntities:c}=n.current;(r.size!==c.size||Array.from(r).some(x=>!c.has(x)))&&(n.current.requestedEntities=r,D(),i())},[n,D,i]);return{entities:o,loading:C,error:A,requestEntities:T}}var W=s(45250);function ie({rootEntityRefs:e,filter:{maxDepth:n=Number.POSITIVE_INFINITY,relations:o,kinds:m,entityFilter:i}={}}){const{entities:y,loading:D,error:C,requestEntities:A}=q();return(0,a.useEffect)(()=>{const E=new Set([...e]),r=new Set;let c=[...e],x=0;for(;c.length>0&&(!isFinite(n)||x<n);){const g=c;for(c=[];g.length>0;){const h=g.shift(),S=y[h];if(r.add(h),S&&S.relations){if(i&&!i(S))continue;for(const p of S.relations)(!o||o.includes(p.type))&&(!m||m.some(L=>p.targetRef.startsWith(`${L.toLocaleLowerCase("en-US")}:`)))&&(r.has(p.targetRef)||(c.push(p.targetRef),E.add(p.targetRef)))}}++x}A([...E])},[y,e,n,o,m,i,A]),{entities:i?(0,W.pickBy)(y,(E,r)=>i(E)):y,loading:D,error:C}}function G({rootEntityRefs:e,maxDepth:n=Number.POSITIVE_INFINITY,unidirectional:o=!0,mergeRelations:m=!0,kinds:i,relations:y,entityFilter:D,onNodeClick:C,relationPairs:A=V.b}){const[T,E]=(0,a.useState)({}),{entities:r,loading:c,error:x}=ie({rootEntityRefs:e,filter:{maxDepth:n,kinds:i,relations:y,entityFilter:D}});return(0,z.A)(()=>{var M;if(!r||Object.keys(r).length===0){E({});return}const g=Object.entries(r).map(([l,d])=>{const t=e.includes(l),v={id:l,entity:d,focused:t,color:t?"secondary":"primary",kind:d.kind,name:d.metadata.name,namespace:d.metadata.namespace||Q.oQ,title:d.metadata.title,spec:d.spec};return C&&(v.onClick=I=>C(v,I)),v}),h=[],S=new Set,p=[...e];for(;p.length>0;){const l=p.pop(),d=r[l];S.add(l),d&&((M=d==null?void 0:d.relations)==null||M.forEach(t=>{var v,I;if(r[t.targetRef]&&!(y&&!y.includes(t.type))&&!(i&&!i.some(N=>t.targetRef.startsWith(`${N.toLocaleLowerCase("en-US")}:`)))){if(!o||!S.has(t.targetRef))if(m){const N=(v=A.find(([oe,ce])=>oe===t.type||ce===t.type))!=null?v:[t.type],[k]=N;h.push({from:k===t.type?l:t.targetRef,to:k===t.type?t.targetRef:l,relations:N,label:"visible"})}else h.push({from:l,to:t.targetRef,relations:[t.type],label:"visible"});if(S.has(t.targetRef)||(p.push(t.targetRef),S.add(t.targetRef)),o){const N=h.findIndex(k=>l===k.from&&t.targetRef===k.to&&!k.relations.includes(t.type));if(N>=0)if(m){const k=(I=A.find(([oe,ce])=>oe===t.type||ce===t.type))!=null?I:[t.type];h[N].relations=[...h[N].relations,...k]}else h[N].relations=[...h[N].relations,t.type]}}}))}const L=h.reduce((l,d)=>{const t=l.findIndex(v=>v.from===d.from&&v.to===d.to);return t>=0?(l[t]={...l[t],relations:Array.from(new Set([...l[t].relations,...d.relations]))},l):[...l,d]},[]);E({nodes:g,edges:L})},100,[r,e,i,y,o,m,C,A]),{loading:c,error:x,...T}}const _=(0,P.A)(e=>({progress:{position:"absolute",left:"50%",top:"50%",marginLeft:"-20px",marginTop:"-20px"},container:{position:"relative",width:"100%",display:"flex",flexDirection:"column"},graph:{width:"100%",flex:1,"& path[marker-end]":{transition:"filter 0.1s ease-in-out"},"& path[marker-end]:hover":{filter:`drop-shadow(2px 2px 4px ${e.palette.primary.dark});`},"& g[data-testid=label]":{transition:"transform 0s"}}}),{name:"PluginCatalogGraphEntityRelationsGraph"}),ee=e=>{const{rootEntityNames:n,maxDepth:o=2,unidirectional:m=!0,mergeRelations:i=!0,kinds:y,relations:D,entityFilter:C,direction:A=X.O.LEFT_RIGHT,onNodeClick:T,relationPairs:E=V.b,className:r,zoom:c="enabled",renderNode:x,renderLabel:g,curve:h,showArrowHeads:S}=e,p=(0,ae.A)(),L=_(),M=(0,a.useMemo)(()=>(Array.isArray(n)?n:[n]).map(N=>(0,f.U2)(N)),[n]),l=(0,$.gf)(te.m),{loading:d,error:t,nodes:v,edges:I}=G({rootEntityRefs:M,maxDepth:o,unidirectional:m,mergeRelations:i,kinds:y,relations:D,entityFilter:C,onNodeClick:T,relationPairs:E});return(0,a.useEffect)(()=>{t&&l.post(t)},[l,t]),a.createElement("div",{className:O()(L.container,r)},d&&a.createElement(se.A,{className:L.progress}),v&&I&&a.createElement(U.w,{nodes:v,edges:I,renderNode:x||Y,renderLabel:g||R,direction:A,className:L.graph,paddingX:p.spacing(4),paddingY:p.spacing(4),labelPosition:b.D.LabelPosition.RIGHT,labelOffset:p.spacing(1),zoom:c,curve:h,showArrowHeads:S}))}},54361:(le,B,s)=>{s.d(B,{b:()=>U});var f=s(97214);const U=[[f.L8,f.vv],[f.Ey,f.fO],[f.IB,f.ZD],[f.sA,f.jn],[f.Kx,f.Qz],[f.zj,f.u0],[f.nC,f.fT]]},78467:(le,B,s)=>{s.d(B,{A:()=>O});var f=s(89575),U=s(39850),b=s(14041),$=s(9546),te=s(7031),se=s(11192),P=44,ae=function(u){return{root:{display:"inline-block"},static:{transition:u.transitions.create("transform")},indeterminate:{animation:"$circular-rotate 1.4s linear infinite"},determinate:{transition:u.transitions.create("transform")},colorPrimary:{color:u.palette.primary.main},colorSecondary:{color:u.palette.secondary.main},svg:{display:"block"},circle:{stroke:"currentColor"},circleStatic:{transition:u.transitions.create("stroke-dashoffset")},circleIndeterminate:{animation:"$circular-dash 1.4s ease-in-out infinite",strokeDasharray:"80px, 200px",strokeDashoffset:"0px"},circleDeterminate:{transition:u.transitions.create("stroke-dashoffset")},"@keyframes circular-rotate":{"0%":{transformOrigin:"50% 50%"},"100%":{transform:"rotate(360deg)"}},"@keyframes circular-dash":{"0%":{strokeDasharray:"1px, 200px",strokeDashoffset:"0px"},"50%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-15px"},"100%":{strokeDasharray:"100px, 200px",strokeDashoffset:"-125px"}},circleDisableShrink:{animation:"none"}}},ne=b.forwardRef(function(u,re){var R=u.classes,K=u.className,w=u.color,F=w===void 0?"primary":w,H=u.disableShrink,Q=H===void 0?!1:H,j=u.size,Y=j===void 0?40:j,V=u.style,X=u.thickness,z=X===void 0?3.6:X,Z=u.value,J=Z===void 0?0:Z,q=u.variant,W=q===void 0?"indeterminate":q,ie=(0,U.A)(u,["classes","className","color","disableShrink","size","style","thickness","value","variant"]),G={},_={},ee={};if(W==="determinate"||W==="static"){var e=2*Math.PI*((P-z)/2);G.strokeDasharray=e.toFixed(3),ee["aria-valuenow"]=Math.round(J),G.strokeDashoffset="".concat(((100-J)/100*e).toFixed(3),"px"),_.transform="rotate(-90deg)"}return b.createElement("div",(0,f.A)({className:(0,$.default)(R.root,K,F!=="inherit"&&R["color".concat((0,se.A)(F))],{determinate:R.determinate,indeterminate:R.indeterminate,static:R.static}[W]),style:(0,f.A)({width:Y,height:Y},_,V),ref:re,role:"progressbar"},ee,ie),b.createElement("svg",{className:R.svg,viewBox:"".concat(P/2," ").concat(P/2," ").concat(P," ").concat(P)},b.createElement("circle",{className:(0,$.default)(R.circle,Q&&R.circleDisableShrink,{determinate:R.circleDeterminate,indeterminate:R.circleIndeterminate,static:R.circleStatic}[W]),style:G,cx:P,cy:P,r:(P-z)/2,fill:"none",strokeWidth:z})))});const O=(0,te.A)(ae,{name:"MuiCircularProgress",flip:!1})(ne)}}]);})();

//# sourceMappingURL=6624.873b67db.chunk.js.map